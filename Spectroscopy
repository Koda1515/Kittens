import matplotlib
import matplotlib.pyplot as plt
%matplotlib notebook
import os.path 
from os import listdir
import os, sys

from IPython.core.display import HTML
from IPython.core.pylabtools import figsize
from ipywidgets import interact, interactive, fixed
from IPython.display import clear_output, display, HTML
from IPython.html import widgets
from PIL import Image

import numpy as np
import math as m
import csv


#GRAPHS ALL ON TOP OF ANOTHER -- INTENSITY VS MAGNETIC FIELD
path = '/Users/kellygarcia/Downloads/Spectroscopy-master/Programs/Port_4/'
dirs = os.listdir(path)
wavelength = []
intensity = []
for filename in dirs:
    if filename.startswith("1.6kW_25sccm_3.2mT_000") and filename.endswith(".txt"):
        if filename[22:24] < '31':
            #print filename
            read = open(path + filename, "r")
            reader = csv.reader(read, delimiter='\n')
            result = np.array(list(reader))
            #print filename
            for i in range(17, len(result)-1):
                p = result[i]
                dat = p[0].split('\t')
                w = float(dat[0])
                i = float(dat[1])
                wavelength.append(w)
                intensity.append(i)
figsize(9,5)
x = wavelength
y = intensity

plt.xlabel('Wavelength (nm)')
plt.ylabel('Intensity')
plt.plot(x,y,color='r')
#t = os.path.basename(f.name)
#plt.title(t)

#plt.savefig('/Users/kellygarcia/Downloads/Spectroscopy-master/Programs/Port_4/' + str(t[0:24]) + '.png')

#f.close()
print len(wavelength)

#3D PLOT!!!!!
from mpl_toolkits.mplot3d.axes3d import Axes3D
from matplotlib import cm
from matplotlib import animation
from matplotlib.ticker import LinearLocator, FormatStrFormatter

fig = plt.figure(figsize=(22, 14))
#ax = fig.add_subplot(111, projection='3d')
ax = fig.gca(projection= '3d')

new_wavelength = [wavelength[i:i+3648] for i in range(0, len(wavelength), 3648)]
new_intensity = [intensity[i:i+3648] for i in range(0, len(intensity), 3648)]

X = np.array(new_wavelength)
Z = np.array(new_intensity)

Y = np.array([[i]*3648 for i in range(230,530+10,10)])


surf = ax.plot_surface(X, Y, Z, cmap=cm.coolwarm, rstride=1, cstride=4)
#xs, ys, zs=0, zdir='z', s=20, c=None, depthshade=True, *args, **kwargs)
#rstride=1, cstride=4, linewidth=0)
 #linewidth=0, antialiased=False)  #

fig.colorbar(surf, shrink=.5, aspect=5)

ax.set_xlabel('Wavelength (nm)')
ax.set_ylabel('Magnetic Field (Amp --> Gauss)')
ax.set_zlabel('Intensity')

print "done"
